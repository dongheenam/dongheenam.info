{{/* Usage: 
    {{% figure src="fig-link" id="fig-id" class="fullwidth" alt="alt-text"
        caption="figure caption"
    %}} 
*/}}
{{- $img_src := .Get "src" -}}
<figure>
{{- if (.Get "caption") -}}
{{- $fig_id := .Get "id" | default (path.Base $img_src) -}}
<label for="{{ $fig_id }}" class="margin-toggle">&#8853;</label>
<input type="checkbox" id="{{ $fig_id }}" class="margin-toggle" />
<span class="marginnote">
    {{ .Get "caption" | markdownify }}
</span>
{{- end -}}
<img{{ with (.Get "class") }}class="{{ . }}"{{ end }}
  src="{{ $img_src }}" alt='{{ .Get "alt" }}' loading="lazy" />
</figure>