{{/* Automatically resizes images and generates an srcset of images */}}
{{/* Usage: 
    {{% resp-image image="path" alt="alt text"
        style="optional css style" class="optional css class" location="main|fullwidth|sidenote"
    %}} 
*/}}
{{- $base_url := site.Params.cloudinary_url -}}
{{- $img := .image }}
{{/* defining sizes */}}
{{- $sizes := "" -}}
{{- if eq .loc "sidenote" -}}
    {{ $sizes = "(min-width: 1620px) 375px, (min-width: 1220px) 225px, (min-width: 780px) 85vw, 95vw" }}
{{- else -}}
    {{ $sizes = "100vw" }}
{{- end -}}
{{/* printing sources */}}
<img 
  loading="lazy" decoding="async" 
  {{ with .class -}} class="{{ . }}"{{- end -}}
  {{- with .style -}} style="{{ . | safeCSS }}"{{- end -}}
  srcset="{{ $base_url }}/f_auto,q_auto,w_400/{{ $img }} 400w,
          {{ $base_url }}/f_auto,q_auto,w_768/{{ $img }} 768w,
          {{ $base_url }}/f_auto,q_auto,w_1024/{{ $img }} 1024w,
          {{ $base_url }}/f_auto,q_auto,w_1680/{{ $img }} 1680w"
  sizes="{{ $sizes }}"
  alt="{{ .alt }}"
  src="{{ $base_url }}/{{ $img }}" />