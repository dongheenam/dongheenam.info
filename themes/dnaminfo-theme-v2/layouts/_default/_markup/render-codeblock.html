{{/*
  custom code highlighting hook for filename support
  Usage:
    ```python {path="/lib/code.py"}
    print("hello, world!")
    ```
*/}}
{{/* language options */}}
{{ $lang := .Type | default "text" }}
{{ if eq (lower $lang) "html" }}
  {{ $lang = "go-html-template" }}
{{ else if not (transform.CanHighlight $lang) }}
  {{ $lang = "text" }}
{{ end }}
{{ $options := .Options }}
{{ $path := index .Attributes "path" }}
{{ $id := index .Attributes "id" }}
{{ $line_start := index .Options "linenostart" }}
{{ if $path }}
  {{ $options = merge (dict "linenos" "table") $options }}
{{ end }}
{{ with $id }}
  {{ $options = merge (dict "lineanchors" .) $options }}
{{ end }}
{{/* render codeblock */}}
<div class="codeblock">
  {{- with $path -}}
    <div class="code-header"><span>{{ . }}</span></div>
  {{- end -}}
  <div class="code-body" {{ with $id }}id="code-{{ . }}"{{ end }}>
    {{- highlight .Inner $lang $options -}}
    {{- $code_text := replace .Inner "\r" "" | safeJS -}}
    <button class="code-copy" title="copy code" onclick="copyText('{{ $code_text }}')">
    <svg focusable="false" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="20" height="20" viewBox="0 0 32 32" aria-hidden="true"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z"></path></svg>
  </button>
  </div>
</div>